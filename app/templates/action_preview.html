{% extends "base.html" %}
{% block content %}
<div class="card">
  <h1>Dry-run preview</h1>
  <p><strong>{{ item.name }}</strong></p>
  <ul class="list">
    <li>Action: {{ plan.action }}</li>
    <li>Move media: {{ 'Yes' if plan.will_move_media else 'No' }}</li>
    <li>Remove torrent: {{ 'Yes' if plan.will_remove_torrent else 'No' }}</li>
  </ul>
  {% if plan.warnings %}
  <div class="alert">
    <strong>Warnings</strong>
    <ul>
      {% for warning in plan.warnings %}
      <li>{{ warning }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
  {% if rule_eval %}
  <div class="card">
    <strong>Rule evaluation</strong>
    <p class="muted">
      {{ 'Meets thresholds' if rule_eval.ok else 'Below thresholds' }} ({{ rule_eval.reason }})
    </p>
    <ul class="list">
      <li>Seed time: {{ rule_eval.seed_time_seconds|seedtime if rule_eval.seed_time_seconds is defined else '-' }}</li>
      <li>Ratio: {{ "%.2f"|format(rule_eval.ratio) if rule_eval.ratio is defined else '-' }}</li>
      <li>Seeders: {{ rule_eval.seeders if rule_eval.seeders is defined else '-' }}</li>
      <li>Min seed time (minutes): {{ rule_eval.min_seed_time_minutes }}</li>
      <li>Min ratio: {{ rule_eval.min_seed_ratio }}</li>
      <li>Min seeders: {{ rule_eval.min_seeders }}</li>
    </ul>
  </div>
  {% endif %}
  <form method="post" action="/media/{{ item.id }}/execute">
    <input type="hidden" name="action" value="{{ plan.action }}" />
    <label class="inline">
      <input type="checkbox" name="confirm" value="yes" required /> I understand this will move files to .trash.
    </label>
    <div class="actions">
      <button type="submit">Confirm action</button>
      <a class="button ghost" href="/libraries/{{ library.id }}">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}
